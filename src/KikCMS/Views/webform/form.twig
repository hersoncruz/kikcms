{# @var form Phalcon\Forms\Form #}
{# @var errorContainer \KikCMS\Classes\WebForm\ErrorContainer #}
{# @var security \Phalcon\Security #}

{{ form({name: 'form'}) }}

    {% if errorContainer.hasFormErrors %}
        <div class="alert alert-danger">
            {% for error in errorContainer.formErrors %}
                <div class="error">{{ error }}</div>
            {% endfor %}
        </div>
    {% endif %}

    {% for element in form.elements %}
        {% set errorMessages = errorContainer.errorsForField(element.name) %}
        {% set hasError = errorContainer.fieldHasError(element.name) %}

        <div class="form-group{{ hasError ? ' has-error has-feedback' : '' }}" title="{{ errorMessages|join("\n") }}">
            {% if(placeHolderAsLabel == false) %}
                {{ form.label(element.name)|raw }}
            {% endif %}
            {{ form.render(element.name)|raw }}
            {% if hasError %}
                <span class="glyphicon glyphicon-remove form-control-feedback"></span>
            {% endif %}
        </div>
    {% endfor %}

    <div class="form-group">
        {{ submitButton(sendButtonLabel, {'class': 'btn btn-submit btn-block', 'name': 'submit'}) }}
    </div>

    <input type="hidden" name="{{ security.tokenKey }}" value="{{ security.token }}"/>

{{ endForm() }}
